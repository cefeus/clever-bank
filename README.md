
# Clever bank

Консольное приложение банка с внедрением сервлетов.

## Функции

- Пополнение счета
- Снятие средств со счета
- Сопровождение операций чеком
- Формирование выписки о транзакциях (за месяц, год, все время)
- Формирование выписки money-statement за выбранный промежуток времени
- Валидация значений

## Технологии и требования

### Использованные технологии 

-  Java 17
- Gradle 
- PostgreSQL
- JDBC
- Lombok
- Servlets (формирование money-statement)
- с3p0 (datasource manager)

### Требования

- отсутствие Spring и Hibernate 
- хранить значения в конфигурационном файле - .yml
- придерживаться git-flow: master - develop - feature/fix
- таблицы в базе данных соответствуют третьей нормальной
форме


## Запуск приложения

Для запуска приложения необходимо: 
- скопировать репозиторий на свое устройство
- в PostgerSQL создать базу данных cleverbank

В уже скопированном репозитории заполнить несколько значений: 
- в файле src/main/recources/application.yml ввести напротив поля **USERNAME** логин, установленный вами при установке PostgerSQL, без кавычек и разделительных знаков
- в файле src/main/recources/application.yml ввести напротив поля **PASSWORD** пароль, установленный вами при установке PostgerSQL, без кавычек и разделительных знаков
- в файле src/main/utils/constants/CheckConstants в значении переменной **STATEMENT_PATH** прописать полный путь до папки, в которой вы хотели бы сохранять все выписки (transacion statement, money statement) вместо символов **YOUR_ABSOLUTE_PATH**

****Важно**** Папка должна существовать

После выполнения всех описанных пунктов необходимо сформировать и задеплоить артефакт. 
1. Для этого переходим в gradle->Tasks->build. Дабл клик по war.
2. Нажимаем на more actions(три точки) возле кнопок run и debug. Edit->Tomcat Server -> Tomcat.
3. Переходим на вкладку deployment. Деплоим артефакт, очищаем поле application context. 

### После этого 

- запускаем сервлет 
- запускаем метод main 

## База данных 

Используемая база данных - PostgerSQL. 
Для использования приложения не требуется производить дополнительную конфигурацию или создавать схемы и таблицы. 
В приложении используется плагин **flyway** для обновления и контроля версий. 
В базе данных автоматически создастся необходимая схема с таблицами и данными для взаимодействия с приложением. 

****Важно**** В базе данных можно безболезненно(или почти) изменять ее содержимое, но не ее структуру. 

## Взаимодейсвие с приложением

Функционалом приложения возможно воспользоваться через консоль. Для выбора одного из предложенных вариантов, необходимо ввести номер, который соответствует желаемому варианту. При введении неверного значения приложение вернет вас к первоначальному меню или будет ожидать один из допустимых вариантов. 

***Важно*** В приложении присутствует валидация, поэтому вводимые значения должны соответствовать требуемому шаблону. При несоответствии введенных значений допустимому шаблону, оно уведомит вас и вернет к первоначальной точке меню.

### Гайд по меню

#### Платежи 
Позволяет совершить одно из трех действий: 
- пополнение счета
Пополняет введенный счет на введенную сумму  
- Снятие со счета 
Снимает с введенного счета введенную сумму при наличи доступных средст
- перевод средств
Переводит введенное кол-во средств с одного введенного счета на второй
#### Выписка по транзакциям

Создает выписку по совершенным со счетом транзакциями. Период времени выбирается через консоль.

#### Выход 
Завершает работу приложения.

### Требования к вводимым данным

Основная единица взаимодействия в приложении - номер счета.

Шаблон номера счета: 
    
    BY[0-9]{2}[a-zA-Z]{4}[0-9]{20}

Пример: 

    BY20OLMP31350000001000000933

## Сервлет API 

#### Получение выписки money-statement
Для получения выписки money-statement необходимо в пустой строке браузера ввести следующий поисковой запрос, после знака равно подставляя значения:

```http
  localhost:8080/statements/money-flow?accNumber=&dateFrom=&dateTo=
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `accNumber` | `string` | **Required**. Номер счета |
| `dateFrom` | `string` | **Required**. Начало периода для выписки |
| `dateTo` | `string` | **Required**. Конец периода для выписки|

****Важно**** Параметр accNumber должен соответствовать шаблону номера счета и присутствовать в базе данных.

****Важно**** Дату необходимо вводить в формате ГГГ-ММ-ДД.

Выписка появится в выбранной в начале конфигурации проекта папке. 




